(()=>{"use strict";var t={789:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasHandler=void 0,i.CanvasHandler=class{constructor(t,i){this.canvas=t,this.context=i}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}drawLine(t,i,a,e,s=[],r="#000"){this.context.strokeStyle=r,this.context.beginPath(),this.context.setLineDash(s),this.context.moveTo(t,i),this.context.lineTo(a,e),this.context.stroke()}drawRect(t,i,a,e,s="#000"){this.context.fillStyle=s,this.context.fillRect(t,i,a,e)}drawText(t,i,a,e="#000",s,r){this.context.fillStyle=e,this.context.font=s||"initial",this.context.textAlign=r||"left",this.context.fillText(t,i,a)}}},901:(t,i,a)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Chart=void 0;const e=a(789);i.Chart=class{constructor(t,i){this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.canvasHandler=new e.CanvasHandler(this.canvas,this.context),this.padding=i,this.initializeChartDimensions()}initializeChartDimensions(){this.chartWidth=this.canvas.width-2*this.padding,this.chartHeight=this.canvas.height-2*this.padding,this.chartAreaStartX=this.padding,this.chartAreaEndX=this.canvas.width-this.padding,this.chartAreaStartY=this.padding,this.chartAreaEndY=this.canvas.height-this.padding}clear(){this.canvasHandler.clear()}drawAxes(){this.canvasHandler.drawLine(this.chartAreaStartX,this.chartAreaStartY,this.chartAreaStartX,this.chartAreaEndY),this.canvasHandler.drawLine(this.chartAreaStartX,this.chartAreaEndY,this.chartAreaEndX,this.chartAreaEndY),this.canvasHandler.drawLine(this.chartAreaStartX,this.chartAreaStartY,this.chartAreaEndX,this.chartAreaStartY),this.canvasHandler.drawLine(this.chartAreaEndX,this.chartAreaStartY,this.chartAreaEndX,this.chartAreaEndY)}}},136:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CANVAS_PADDING=i.BAR_WIDTH=i.CHARTS=void 0,i.CHARTS=[{canvasId:"chartCanvas1",apiUrl:"https://beta.forextester.com/data/api/Metadata/bars/chunked?Broker=Advanced&Symbol=EURUSD&Timeframe=1&Start=57674&End=59113&UseMessagePack=false"},{canvasId:"chartCanvas2",apiUrl:"https://beta.forextester.com/data/api/Metadata/bars/chunked?Broker=Advanced&Symbol=USDJPY&Timeframe=1&Start=57674&End=59113&UseMessagePack=false"}],i.BAR_WIDTH=1,i.CANVAS_PADDING=50},118:function(t,i,a){var e=this&&this.__awaiter||function(t,i,a,e){return new(a||(a=Promise))((function(s,r){function h(t){try{c(e.next(t))}catch(t){r(t)}}function n(t){try{c(e.throw(t))}catch(t){r(t)}}function c(t){var i;t.done?s(t.value):(i=t.value,i instanceof a?i:new a((function(t){t(i)}))).then(h,n)}c((e=e.apply(t,i||[])).next())}))};Object.defineProperty(i,"__esModule",{value:!0}),i.CandlestickChart=void 0;const s=a(901),r=a(136),h=a(488);class n extends s.Chart{constructor(t,i){super(t,r.CANVAS_PADDING),this.apiUrl=i,this.offsetX=0,this.maxOffset=0,this.isDragging=!1,this.dragStartX=0,this.lastOffsetX=0,this.offsetY=0,this.lastOffsetY=0,this.isYZooming=!1,this.dragStartY=0,this.barWidth=r.BAR_WIDTH,this.tickVolumeDevider=1e8,this.initializeEventListeners(),this.fetchDataAndDraw()}initializeEventListeners(){this.canvas.addEventListener("mousedown",this.startDragging.bind(this)),this.canvas.addEventListener("mousemove",this.drag.bind(this)),this.canvas.addEventListener("mouseup",this.stopDragging.bind(this)),this.canvas.addEventListener("mouseleave",this.stopDragging.bind(this)),this.canvas.addEventListener("wheel",this.handleZoom.bind(this))}fetchDataAndDraw(){return e(this,void 0,void 0,(function*(){const t=document.getElementById(`loader__${this.canvas.getAttribute("id")}`);try{const i=yield fetch(this.apiUrl);if(!i.ok)throw new Error(`${i.statusText}`);const a=yield i.json();this.data=a,this.calculateInitialPriceRange(),this.maxOffset=this.getMaxOffset(),this.tickVolumeDevider=this.getTickVolumeDevider(),t.style.display="none",this.draw()}catch(i){console.log(i),t.style.display="none",(0,h.displayError)(i,this.canvas.getAttribute("id"))}}))}draw(){super.clear(),this.drawTimeLabels(),this.drawPriceLabels(),this.drawCandlesticks(),super.drawAxes()}calculateInitialPriceRange(){const t=this.data.flatMap((t=>[...t.Bars.flatMap((t=>t.High)),...t.Bars.flatMap((t=>t.Low))]));this.minPriceInitial=Math.min(...t),this.maxPriceInitial=Math.max(...t),this.minPrice=this.minPriceInitial,this.maxPrice=this.maxPriceInitial,this.priceRangeInitial=this.maxPrice-this.minPrice}getTickVolumeDevider(){return Math.max(...this.data.flatMap((t=>t.Bars.flatMap((t=>t.TickVolume)))))/this.chartHeight*5}getMaxOffset(){const t=this.data.reduce(((t,i)=>t+i.Bars.length),0);return Math.max(0,t*this.barWidth*2-this.chartWidth)}drawCandlesticks(){const t=this.chartHeight/(this.maxPrice-this.minPrice);let i=this.chartAreaStartX-this.offsetX;for(const a of this.data)for(const e of a.Bars){if(i>this.chartAreaEndX)break;if(i+this.barWidth>=this.chartAreaStartX){const a=this.getCandlestickWidth(i);this.drawTickVolume(i,a,e.TickVolume),this.drawCandlestick(i,e,this.minPrice,t,a)}i+=2*this.barWidth}}getCandlestickWidth(t){return t<this.chartAreaStartX?this.barWidth-(this.chartAreaStartX-t):t>this.chartAreaEndX-this.barWidth?this.chartAreaEndX-t:this.barWidth}drawCandlestick(t,i,a,e,s){const r=this.getPriceY(i.Open,a,e)+this.offsetY,h=this.getPriceY(i.Close,a,e)+this.offsetY,n=this.getPriceY(i.High,a,e)+this.offsetY,c=this.getPriceY(i.Low,a,e)+this.offsetY,d=i.Open>i.Close?"red":"green";t<this.chartAreaEndX-this.barWidth/2&&t>this.chartAreaStartX-this.barWidth/2&&(this.context.fillStyle=d,this.canvasHandler.drawLine(...this.getCandlestickLineCoordinates(t,n,c),[],d));const o=Math.min(r,h);if(o>this.chartAreaEndY)return;let l=o,f=Math.abs(r-h);o<this.chartAreaStartY&&(l=this.chartAreaStartY,f=o+f<this.chartAreaStartY?0:f-(this.chartAreaStartY-o)),o+f>this.chartAreaEndY&&(f=this.chartAreaEndY-o);const g=t<this.chartAreaStartY?this.chartAreaStartY:t;this.canvasHandler.drawRect(g,l,s,f,d)}drawTickVolume(t,i,a){const e=a/this.tickVolumeDevider,s=t<this.chartAreaStartX?this.chartAreaStartX:t,r=this.chartAreaEndY-a/this.tickVolumeDevider;this.canvasHandler.drawRect(s,r,i,e,"#ccc")}getCandlestickLineCoordinates(t,i,a){let e=i,s=a;return e<this.chartAreaStartY&&(s<=this.chartAreaStartY?(e=0,s=0):e=this.chartAreaStartY),s>this.chartAreaEndY&&(e>this.chartAreaEndY?(e=0,s=0):s=this.chartAreaEndY),[t+this.barWidth/2,e,t+this.barWidth/2,s]}getPriceY(t,i,a){return this.chartAreaEndY-(t-i)*a}drawTimeLabels(){const t=(0,h.getLabelFrequency)(this.barWidth);let i=this.chartAreaStartX-this.offsetX+this.barWidth/2,a=0;for(const e of this.data)for(const[s,r]of e.Bars.entries()){if(i>this.chartAreaEndX)break;if(i+this.barWidth>=this.chartAreaStartX&&i>=this.chartAreaStartX){const h=new Date(1e3*e.ChunkStart+1e3*r.Time);if(a%t==0){const e=this.formatDate(h,t,0===s);this.canvasHandler.drawText(e,i,this.chartAreaEndY+15,"#000","10px Arial","center"),0!==a&&this.canvasHandler.drawLine(i,this.chartAreaStartX,i,this.chartAreaEndY,[5,10],"#ccc")}}a++,i+=2*this.barWidth}}formatDate(t,i,a){return a&&i>10?(0,h.getFullDateString)(t):(0,h.getTimeString)(t)}drawPriceLabels(){const t=this.chartHeight/(this.maxPrice-this.minPrice),i=this.maxPrice-this.minPrice,a=this.getPriceStep(i);for(let i=0!==this.offsetY?this.minPriceInitial:this.minPrice;i<=(0!==this.offsetY?this.maxPriceInitial:this.maxPrice);i+=a){const a=this.getPriceY(i,this.minPrice,t)+this.offsetY;a>=this.chartAreaStartY&&a<=this.chartAreaEndY+2&&(this.canvasHandler.drawText(i.toFixed(4),this.chartAreaEndX+5,a+2),this.canvasHandler.drawLine(this.chartAreaStartX,a,this.chartAreaEndX,a,[5,10],"#ccc"))}}getPriceStep(t){return t/8}startDragging(t){t.clientX<this.chartAreaEndX?(this.isDragging=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY,this.lastOffsetX=this.offsetX,this.lastOffsetY=this.offsetY,this.canvas.style.cursor="grabbing"):(this.isYZooming=!0,this.dragStartY=t.clientY,this.canvas.style.cursor="ns-resize")}drag(t){this.isDragging&&this.handleDrag(t),this.isYZooming&&this.handleZoomY(t)}stopDragging(){this.isDragging=!1,this.isYZooming=!1,this.canvas.style.cursor="default"}handleZoomY(t){const i=t.clientY-this.dragStartY>0?1.01:.99,a=this.maxPrice-this.minPrice;if(i<1&&a<this.priceRangeInitial/20)return;if(i>1&&a>=this.priceRangeInitial)return;const e=a*i,s=(this.maxPrice+this.minPrice)/2;this.maxPrice=s+e/2,this.minPrice=s-e/2,this.draw()}handleDrag(t){const i=t.clientX-this.dragStartX,a=t.clientY-this.dragStartY;this.offsetX=Math.min(this.maxOffset,Math.max(0,this.lastOffsetX-i));const e=this.lastOffsetY+a,s=(this.maxPrice-this.minPrice)/this.chartHeight,r=this.minPrice+e*s,h=this.maxPrice+e*s;r>=this.minPriceInitial&&h<=this.maxPriceInitial&&(this.offsetY=e),this.draw()}handleZoom(t){t.preventDefault();const i=t.deltaY>0?-.5:.5,a=this.barWidth+i;if(a>=1&&a<=60){const t=a/this.barWidth;this.barWidth=a,this.maxOffset=this.getMaxOffset(),this.offsetX=Math.min(this.offsetX*t,this.maxOffset),this.draw()}}}i.CandlestickChart=n,document.addEventListener("DOMContentLoaded",(function(){r.CHARTS.forEach((t=>new n(t.canvasId,t.apiUrl)))}))},488:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFullDateString=function(t){return`${t.getUTCDate().toString().padStart(2,"0")}.${(t.getUTCMonth()+1).toString().padStart(2,"0")} ${t.getUTCHours()}:${t.getUTCMinutes().toString().padStart(2,"0")}`},i.getTimeString=function(t){return`${t.getUTCHours()}:${t.getUTCMinutes().toString().padStart(2,"0")}`},i.displayError=function(t,i){document.getElementById(`error__${i}`).textContent=`Failed to load data: ${t}`},i.getLabelFrequency=function(t){return t>15?1:t>8?5:t>5?10:t>3?15:20}}},i={};!function a(e){var s=i[e];if(void 0!==s)return s.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}(118)})();